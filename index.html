<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì…ì§€ í‰ê°€ ìë™í™” ì‹œìŠ¤í…œ</title>
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=YOUR_CLIENT_ID&submodules=geocoder"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #f4f4f4; }
    h1 { color: #2b6cb0; }
    #map { width: 100%; height: 400px; margin-top: 20px; }
    .result { margin-top: 20px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    input, button { padding: 8px; font-size: 16px; margin: 5px 0; }
    .chart-container { width: 400px; margin-top: 30px; }
  </style>
</head>
<body>
  <h1>ì‹ ê·œ ê±´ì„¤ ì‚¬ì—…ì¥ ì…ì§€ í‰ê°€ ìë™í™” ì‹œìŠ¤í…œ</h1>
  <input type="text" id="address" placeholder="ì‚¬ì—…ì¥ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" size="50">
  <button onclick="searchAddress()">ê²€ìƒ‰</button>

  <div id="map"></div>
  <div class="result" id="scoreOutput"></div>
  <div class="chart-container">
    <canvas id="scoreChart"></canvas>
  </div>

  <script>
    let map;
    let marker;

    function searchAddress() {
      const address = document.getElementById("address").value;
      naver.maps.Service.geocode({ query: address }, function(status, response) {
        if (status !== naver.maps.Service.Status.OK) {
          alert('ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }
        const result = response.v2.addresses[0];
        const lat = parseFloat(result.y);
        const lng = parseFloat(result.x);
        const coord = new naver.maps.LatLng(lat, lng);

        if (!map) {
          map = new naver.maps.Map('map', {
            center: coord,
            zoom: 16
          });
        } else {
          map.setCenter(coord);
        }

        if (marker) marker.setMap(null);
        marker = new naver.maps.Marker({ position: coord, map: map });

        runEvaluation(coord);
      });
    }

    function runEvaluation(coord) {
      // ì˜ˆì‹œ: í•­ëª©ë³„ ì ìˆ˜ë¥¼ ì„ì˜ë¡œ ë¶€ì—¬
      const scores = {
        complexScale: "B",
        infraAccess: "A",
        schoolAccess: "C"
      };
      document.getElementById("scoreOutput").innerHTML = `
        <strong>ì…ì§€ í‰ê°€ ê²°ê³¼:</strong><br>
        ğŸ¢ ì£¼ê±° ë‹¨ì§€ ê·œëª¨: ${scores.complexScale}<br>
        ğŸ§ ì¸í”„ë¼ ì ‘ê·¼ì„±: ${scores.infraAccess}<br>
        ğŸ« ì´ˆë“±í•™êµ ì ‘ê·¼ì„±: ${scores.schoolAccess}
      `;

      const labels = ["ì£¼ê±°ë‹¨ì§€", "ì¸í”„ë¼", "ì´ˆë“±í•™êµ"];
      const data = [
        scoreToNumber(scores.complexScale),
        scoreToNumber(scores.infraAccess),
        scoreToNumber(scores.schoolAccess)
      ];
      drawChart(labels, data);
    }

    function scoreToNumber(score) {
      return { A: 5, B: 4, C: 3, D: 2, E: 1 }[score] || 0;
    }

    function drawChart(labels, data) {
      const ctx = document.getElementById('scoreChart');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'ì…ì§€ í‰ê°€ ì ìˆ˜',
            data: data,
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: { beginAtZero: true, max: 5 }
          }
        }
      });
    }
  </script>
</body>
</html>
